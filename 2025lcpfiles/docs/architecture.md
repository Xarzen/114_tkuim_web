# 系統架構說明

## 整體架構圖

```
┌─────────────────────────────────────────────────────────────┐
│                        使用者瀏覽器                           │
│                      (Web Browser)                          │
└────────────────────────┬────────────────────────────────────┘
                         │ HTTP Request/Response
                         │
┌────────────────────────▼────────────────────────────────────┐
│                    前端 (Frontend)                           │
│              React + Vite + Tailwind CSS                    │
│                   Port: 3000                                │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  Pages (頁面)                                         │  │
│  │  - Home (首頁選手列表)                                │  │
│  │  - PlayerDetail (選手詳細資訊)                        │  │
│  │  - AddPlayer (新增選手)                               │  │
│  │  - EditPlayer (編輯選手)                              │  │
│  └──────────────────────────────────────────────────────┘  │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  Components (元件)                                    │  │
│  │  - Navbar (導覽列)                                    │  │
│  │  - PlayerCard (選手卡片)                              │  │
│  │  - PlayerForm (表單)                                  │  │
│  └──────────────────────────────────────────────────────┘  │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  Services (服務層)                                    │  │
│  │  - API Service (Axios)                               │  │
│  └──────────────────────────────────────────────────────┘  │
└────────────────────────┬────────────────────────────────────┘
                         │ RESTful API
                         │ (Axios HTTP Requests)
                         │
┌────────────────────────▼────────────────────────────────────┐
│                    後端 (Backend)                            │
│                 Node.js + Express.js                        │
│                   Port: 5000                                │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  Routes (路由層)                                      │  │
│  │  - playerRoutes.js                                   │  │
│  │    定義 API 端點 (GET, POST, PUT, DELETE)             │  │
│  └──────────────────────────────────────────────────────┘  │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  Controllers (控制器層)                               │  │
│  │  - playerController.js                               │  │
│  │    處理商業邏輯與請求回應                              │  │
│  └──────────────────────────────────────────────────────┘  │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  Models (資料模型層)                                  │  │
│  │  - Player.js (Mongoose Schema)                       │  │
│  │    定義資料結構與驗證規則                              │  │
│  └──────────────────────────────────────────────────────┘  │
└────────────────────────┬────────────────────────────────────┘
                         │ Mongoose ODM
                         │ (MongoDB Driver)
                         │
┌────────────────────────▼────────────────────────────────────┐
│                   資料庫 (Database)                          │
│                      MongoDB                                │
│                   Port: 27017                               │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  Database: cfo_team_db                               │  │
│  │  ┌────────────────────────────────────────────────┐  │  │
│  │  │  Collection: players                            │  │  │
│  │  │  - _id (ObjectId)                               │  │  │
│  │  │  - name (選手姓名)                               │  │  │
│  │  │  - gameId (遊戲ID)                              │  │  │
│  │  │  - position (位置)                               │  │  │
│  │  │  - photoUrl (照片網址)                           │  │  │
│  │  │  - introduction (介紹)                           │  │  │
│  │  │  - achievements (成就)                           │  │  │
│  │  │  - age (年齡)                                    │  │  │
│  │  │  - nationality (國籍)                            │  │  │
│  │  │  - createdAt (建立時間)                          │  │  │
│  │  │  - updatedAt (更新時間)                          │  │  │
│  │  └────────────────────────────────────────────────┘  │  │
│  └──────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
```

## 技術棧說明

### 前端技術
- **React 18**: 現代化 JavaScript 框架，使用元件化開發
- **Vite**: 快速的前端建置工具
- **React Router v6**: 前端路由管理
- **Axios**: HTTP 客戶端，用於 API 請求
- **Tailwind CSS**: Utility-first CSS 框架，快速建構 UI

### 後端技術
- **Node.js**: JavaScript 執行環境
- **Express.js**: Web 應用框架
- **Mongoose**: MongoDB ODM (Object Data Modeling)
- **CORS**: 跨域資源共享中間件
- **dotenv**: 環境變數管理

### 資料庫
- **MongoDB**: NoSQL 文件型資料庫

## 設計模式應用

### 1. MVC 架構模式 (Model-View-Controller)
- **Model** (models/Player.js): 定義資料結構與商業規則
- **View** (React Components): 使用者介面呈現
- **Controller** (controllers/playerController.js): 處理請求邏輯

### 2. RESTful API 設計模式
- 使用 HTTP 方法對應 CRUD 操作
- 統一的資源命名 (`/api/players`)
- 標準化的回應格式

### 3. Repository Pattern (資料存取層)
- Mongoose Model 作為資料存取的抽象層
- 隔離資料庫操作與商業邏輯

### 4. Service Layer Pattern (服務層)
- 前端使用 `api.js` 統一管理 API 請求
- 封裝所有與後端的通訊邏輯

## 資料流程

### 查詢選手流程 (Read)
```
使用者 → 前端 Page → API Service → 後端 Route → Controller → Model → MongoDB
                                                                    ↓
使用者 ← 前端 Page ← API Service ← 後端 Route ← Controller ← Model ←
```

### 新增選手流程 (Create)
```
使用者輸入表單 → PlayerForm → API Service (POST) → 後端 Route
                                                      ↓
                                                   Controller
                                                      ↓
                                            驗證資料 (Model)
                                                      ↓
                                                   MongoDB
                                                      ↓
使用者看到結果 ← 重新導向 ← 回應成功 ← Controller ←
```

## API 通訊協定
- **協定**: HTTP/HTTPS
- **資料格式**: JSON
- **請求方法**: GET, POST, PUT, DELETE
- **狀態碼**: 200, 201, 400, 404, 500

## 安全性考量
1. **CORS 設定**: 僅允許前端網域訪問
2. **資料驗證**: Mongoose Schema 驗證
3. **錯誤處理**: 統一的錯誤回應格式
4. **環境變數**: 使用 .env 管理敏感資訊

## 部署架構
```
開發環境 (Development)
- 前端: localhost:3000
- 後端: localhost:5000
- 資料庫: localhost:27017

未來可擴展至生產環境 (Production)
- 前端: Vercel / Netlify
- 後端: Railway / Render / Heroku
- 資料庫: MongoDB Atlas (雲端)
```

## 專案特色
1. **前後端分離**: 便於獨立開發與部署
2. **RESTful API**: 標準化的 API 設計
3. **響應式設計**: 支援各種裝置尺寸
4. **元件化開發**: React 元件可重複使用
5. **完整的 CRUD**: 涵蓋所有基本資料操作
